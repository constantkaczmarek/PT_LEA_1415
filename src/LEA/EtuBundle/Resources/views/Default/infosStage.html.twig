{% extends "::base.html.twig" %}


{% block body %}

    {# Add ajax thingie that will update the city select box #}
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function () {

            $('#infosMissionForm_entreprise').change(function(){
                var entrCle = $(this).val();

                $.ajax({
                    type: "POST",
                    url: "{{ url('lea_etu_appel_ajax_entr') }}?entrCle="+entrCle,

                    success: function(data) {
                        console.log(data);
                        $('#infosMissionForm_bureau').html('');
                        $.each(data["bureau"], function(k, v) {
                            $('#infosMissionForm_bureau').append('<option value="' + k + '">' + v + '</option>');
                        });

                        $('#infosMissionForm_referent').html('');
                        $.each(data["referent"], function(k, v) {
                            $('#infosMissionForm_referent').append('<option value="' + k + '">' + v + '</option>');
                        });

                        $('#infosMissionForm_referent1').html('');
                        $.each(data["referent"], function(k, v) {
                            $('#infosMissionForm_referent1').append('<option value="' + k + '">' + v + '</option>');
                        });
                    }
                });
                return false;
            });

            $('#infosMissionForm_entrepriseAlt').change(function(){
                var entrCle = $(this).val();

                $.ajax({
                    type: "POST",
                    url: "{{ url('lea_etu_appel_ajax_regie') }}?entrCle="+entrCle,

                    success: function(data) {
                        console.log(data);
                        $('#infosMissionForm_bureauAlt').html('');
                        $.each(data["bureau"], function(k, v) {
                            $('#infosMissionForm_bureauAlt').append('<option value="' + k + '">' + v + '</option>');
                        });

                        $('#infosMissionForm_referentAlt').html('');
                        $.each(data["referent"], function(k, v) {
                            $('#infosMissionForm_referentAlt').append('<option value="' + k + '">' + v + '</option>');
                        });

                        $('#infosMissionForm_referent1Alt').html('');
                        $.each(data["referent"], function(k, v) {
                            $('#infosMissionForm_referent1Alt').append('<option value="' + k + '">' + v + '</option>');
                        });
                    }
                });
                return false;
            });

        });
    </script>
    <div class="container-fluid">

        {{ form_start(form) }}

            <div>
                {{ form_errors(form) }}
            </div>

            <div>
                {{ form_row(form.tel) }}
            </div>
            <div>
                {{ form_row(form.mail) }}
            </div>
            <div>
                {{ form_row(form.mailLille1) }}
            </div>
            <div>
                {{ form_row(form.tuteur) }}
            </div>
            <div>
                {{ form_row(form.entreprise,  {'attr':{'id':'entrCle'} }) }}
            </div>
            <div>
                {{ form_row(form.bureau) }}
            </div>
            <div>
                {{ form_row(form.referent) }}
            </div>
            <div>
                {{ form_row(form.referent1) }}
            </div>
            <div>
                {{ form_row(form.datecontrat) }}
            </div>
            <div>
                {{ form_row(form.dateDebutcontrat) }}
            </div>
            <div>
                {{ form_row(form.dateFincontrat) }}
            </div>
            <div>
                {{ form_row(form.entrepriseAlt) }}
            </div>
            <div>
                {{ form_row(form.bureauAlt) }}
            </div>
            <div>
                {{ form_row(form.referentAlt) }}
            </div>
            <div>
                {{ form_row(form.referent1Alt) }}
            </div>

            <input type="submit" name="Enregistrer" value="Enregistrer"/>


        {{ form_end(form) }}

        <div>
            C'est ca : {{ altref }} et {{ infosStage.bureau }}
        </div>
    </div>

{% endblock %}