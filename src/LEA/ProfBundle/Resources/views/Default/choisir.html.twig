{% extends "::base.html.twig" %}

{% block body %}

    {% javascripts '@LEAProfBundle/Resources/Js/choisir.js' %}
        <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}

    {% include "LEAProfBundle:Default:navbar.html.twig" %}

    <div>
        <span>Choisissez la formation : </span>

        <form action="{{  path('lea_prof_changeForm',{'name':name}) }}" method="post">
            <select id="formation" name="formation" >
                {% for forma in listForm.keys %}
                    {% if forma==formation %}
                        <option value="{{ forma }}" selected="selected">{{ listForm.values[loop.index-1] }}</option>
                    {% else %}
                        <option value="{{ forma }}">{{ listForm.values[loop.index-1] }}</option>
                    {% endif %}
                {% endfor %}
            </select>
        </form>

        <span>Choisir situation : </span>

        <form  method="post">
            <select id="situ" name="situ" >
                {% for situ in choixTuteur.keys %}
                    {% if situ==situation %}
                        <option value="{{ situ }}" selected="selected">{{ choixTuteur.values[loop.index-1] }}</option>
                    {% else %}
                        <option value="{{ situ }}">{{ choixTuteur.values[loop.index-1] }}</option>
                    {% endif %}
                {% endfor %}
            </select>
        </form>
    </div>
    <br/>


    {{ form_start(form) }}

        {{ form_errors(form) }}

        <input type="submit" name="Enregistrer" value="Transmettre vos choix" class="btn btn-primary"/>
        <div>
            {{ situation }}
        </div>
        <br/>
        <br/>

        <table class="table table-striped">
                <tr>
                <th>#</th>
                <th>Nom</th>
                <th>Prénom</th>
                <th>Formation</th>
                <th>Ville</th>
                <th>Entreprise</th>
                <th>Tuteurs(potentiels)</th>
                <th>Détails</th>
            </tr>

        {% if listEtu %}

            {% if (situation=="EXCL" or situation=="NON")%}

                {% for etu in listEtu %}

                    {% if etu.tuteurs.tuteurRef=="aucun" %}
                        <tr>
                            <td>{{ form_row(form.altCle[loop.index-1]) }}</td>
                            <td>{{ etu.nom_etud }}</td>
                            <td>{{ etu.nom_prenom }}</td>
                            <td>{{ etu.formation }}</td>
                            <td>{{ etu.ville }}/<a href="{{ etu.lienDistance }}">{{ etu.distance }}</a></td>
                            <td>{{ etu.entreprise }}</td>
                            <td>{{ etu.tuteurs.tuteurRef }}</td>
                            <td onclick="showModal({{ etu.alternanceCle }})"><a href="#">Détails</a></td>
                            <td id= "{{ etu.alternanceCle }}" style="visibility: hidden" >
                                <table class="table table-default">
                                    <tr><td>Etudiant </td> <td> {{ etu.nom_etud }}</td></tr>
                                    <tr><td>Referent</td> <td> {{ etu.referent }}</td></tr>
                                    <tr><td>Missions</td><td> {{ etu.mission }}</td></tr>
                                    <tr><td>Services</td><td> {{ etu.service }}</td></tr>
                                    <tr><td>Envirnmnt Tech.</td><td> {{ etu.tech }}</td></tr>
                                    <tr><td><a onclick="hideModal({{ etu.alternanceCle }})">Cacher </a></td><td></td></tr>
                                </table>
                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}

            {% elseif situation=="OUI" %}

                {% for etu in listEtu %}
                    <tr>
                        <td>{{ form_row(form.altCle[loop.index-1]) }}</td>
                        <td>{{ etu.nom_etud }}</td>
                        <td>{{ etu.nom_prenom }}</td>
                        <td>{{ etu.formation }}</td>
                        <td>{{ etu.ville }}/<a href="{{ etu.lienDistance }}">{{ etu.distance }}</a></td>
                        <td>{{ etu.entreprise }}</td>
                        <td>{{ etu.tuteurs.tuteurRef }}</td>
                        <td onclick="showModal({{ etu.alternanceCle }})"><a href="#">Détails</a></td>
                        <td id= "{{ etu.alternanceCle }}" style="visibility: hidden" >
                            <table class="table table-default">
                                <tr><td>Etudiant </td> <td> {{ etu.nom_etud }}</td></tr>
                                <tr><td>Referent</td> <td> {{ etu.referent }}</td></tr>
                                <tr><td>Missions</td><td> {{ etu.mission }}</td></tr>
                                <tr><td>Services</td><td> {{ etu.service }}</td></tr>
                                <tr><td>Envirnmnt Tech.</td><td> {{ etu.tech }}</td></tr>
                                <tr><td><a onclick="hideModal({{ etu.alternanceCle }})">Cacher </a></td><td></td></tr>
                            </table>
                        </td>
                    </tr>
                {% endfor %}


            {% elseif situation=="ENTR" %}
                {% for etu in listEtu %}
                    {% if etu.entreprise != "__sans entreprise__"  %}
                        <tr>
                            <td>{{ form_row(form.altCle[loop.index-1]) }}</td>
                            <td>{{ etu.nom_etud }}</td>
                            <td>{{ etu.nom_prenom }}</td>
                            <td>{{ etu.formation }}</td>
                            <td>{{ etu.ville }}/<a href="{{ etu.lienDistance }}">{{ etu.distance }}</a></td>
                            <td>{{ etu.entreprise }}</td>
                            <td>{{ etu.tuteurs.tuteurRef }}</td>
                            <td onclick="showModal({{ etu.alternanceCle }})"><a href="#">Détails</a></td>
                            <td id= "{{ etu.alternanceCle }}" style="visibility: hidden" >
                                <table class="table table-default">
                                    <tr><td>Etudiant </td> <td> {{ etu.nom_etud }}</td></tr>
                                    <tr><td>Referent</td> <td> {{ etu.referent }}</td></tr>
                                    <tr><td>Missions</td><td> {{ etu.mission }}</td></tr>
                                    <tr><td>Services</td><td> {{ etu.service }}</td></tr>
                                    <tr><td>Envirnmnt Tech.</td><td> {{ etu.tech }}</td></tr>
                                    <tr><td><a onclick="hideModal({{ etu.alternanceCle }})">Cacher </a></td><td></td></tr>
                                </table>
                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </table>

        {% endif %}

    {{ form_end(form) }}

{% endblock %}